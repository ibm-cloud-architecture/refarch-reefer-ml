



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Container Predictive Maintenance - Reefer Container Predictive Maintenance</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reefer-container-predictive-maintenance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Reefer Container Predictive Maintenance" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Reefer Container Predictive Maintenance
            </span>
            <span class="md-header-nav__topic">
              Container Predictive Maintenance
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/jbcodeforce/refarch-reefer-ml/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Reefer Container Predictive Maintenance" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Reefer Container Predictive Maintenance
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/jbcodeforce/refarch-reefer-ml/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../integration-tests/" title="Run integration tests" class="md-nav__link">
      Run integration tests
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Container Predictive Maintenance
      </label>
    
    <a href="./" title="Container Predictive Maintenance" class="md-nav__link md-nav__link--active">
      Container Predictive Maintenance
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predictive-maintenance-problem-statement" title="Predictive maintenance problem statement" class="md-nav__link">
    Predictive maintenance problem statement
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reefer-problem-types" title="Reefer problem types" class="md-nav__link">
    Reefer problem types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" title="Architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-set" title="Data set" class="md-nav__link">
    Data set
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-poweroff" title="1. Poweroff" class="md-nav__link">
    1. Poweroff
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-co2-sensor-malfunction" title="2. Co2 sensor malfunction" class="md-nav__link">
    2. Co2 sensor malfunction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeling-techniques" title="Modeling techniques" class="md-nav__link">
    Modeling techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-execution" title="Code execution" class="md-nav__link">
    Code execution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-description" title="Model description" class="md-nav__link">
    Model description
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linear-regression" title="Linear regression" class="md-nav__link">
    Linear regression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#naive-bayes-classification" title="Naive Bayes classification" class="md-nav__link">
    Naive Bayes classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-evaluation" title="Model evaluation" class="md-nav__link">
    Model evaluation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predictive-maintenance-problem-statement" title="Predictive maintenance problem statement" class="md-nav__link">
    Predictive maintenance problem statement
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reefer-problem-types" title="Reefer problem types" class="md-nav__link">
    Reefer problem types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" title="Architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-set" title="Data set" class="md-nav__link">
    Data set
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-poweroff" title="1. Poweroff" class="md-nav__link">
    1. Poweroff
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-co2-sensor-malfunction" title="2. Co2 sensor malfunction" class="md-nav__link">
    2. Co2 sensor malfunction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeling-techniques" title="Modeling techniques" class="md-nav__link">
    Modeling techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-execution" title="Code execution" class="md-nav__link">
    Code execution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-description" title="Model description" class="md-nav__link">
    Model description
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linear-regression" title="Linear regression" class="md-nav__link">
    Linear regression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#naive-bayes-classification" title="Naive Bayes classification" class="md-nav__link">
    Naive Bayes classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-evaluation" title="Model evaluation" class="md-nav__link">
    Model evaluation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jbcodeforce/refarch-reefer-ml/edit/master/docs/predictive-maintenance.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="reefer-container-predictive-maintenance">Reefer Container Predictive Maintenance</h1>
<p>In this section, we discuss how to build an analytic model using machine learning techniques from data coming from event store like kafka. We train the model with the help of historical data to predict whether maintenance is required for the reefer container at a certain point in time.</p>
<p>You will learn how to simulate date for reefer, develop the predictive maintenance model, and integrate the model into an application.</p>
<h2 id="introduction">Introduction</h2>
<p>A reefer container is a refrigerated shipping container used to store or transport frozen or cold goods perishable items or goods that require temperature control. </p>
<p><img alt="Reefer" src="../images/reefer.png" /></p>
<p>Reefers make an excellent, portable solution for short or long term storage and can be used to ship or truck goods over long distances as they can be plugged into the power station on ships or have it clipped on generators attached.</p>
<p>Perishable products must be kept at a controlled temperature, from point of origin to delivery to retailer or pharmacy. The logistics industry refers to this as the “cold chain” and it encompasses both “reefers” (refrigerated containers) as well as warehouses, distribution centers and the final storage or holding areas.</p>
<p>Throughout this chain the risk of failure is ever-present, meaning there is always a possibility of cargo exceeding permissible or safe temperature levels, even if only briefly. For example, a truck might be stopped without power in desert heat, allowing temperatures in the reefer to rise. Then power is restored and the temperature in the container comes back down, but the product is damaged.</p>
<p>When cargo with such as any of those items listed above are exposed to temperatures outside of prescribed limits it can be damaged. In some cases this is evident, such as with bananas, but in other situations, like the transport of vaccines, it may not be apparent that damage has occurred and the vaccine becomes ineffective. For some products, going over temperature, even only briefly, can reduce shelf life dramatically, incurring substantial costs when it cannot be sold. </p>
<p>Organizations contracting to ship perishable products often specify the permissible temperature range. However, even if it is possible to show that product was exposed to conditions outside of those contracted, proving where it happened, and thus responsibility, can be much harder.</p>
<h2 id="predictive-maintenance-problem-statement">Predictive maintenance problem statement</h2>
<p>The success of predictive maintenance models depend on three main components: </p>
<ul>
<li>having the right data</li>
<li>framing the problem appropriately </li>
<li>evaluating the predictions properly</li>
</ul>
<p>From a methodology point of view the Data Scientist needs to address the following questions:</p>
<ul>
<li>What type of failure to consider and which one to predict?</li>
<li>What kind of failure is happening? slow degradation or instantaneous failure?</li>
<li>What could be the relation between a product characteristics and the failure?</li>
<li>What kind of measure exist to assess the given characteristic?</li>
<li>Which measurements correspond to good functioning and which ones correspond to failure?</li>
<li>How often metrics are reported?</li>
<li>What question the model should answer?</li>
<li>What kind of output should the model give?</li>
<li>How long in advance should the model be able to indicate that a failure will occur?</li>
<li>What are the business impact to do not predict the failure? and predicting false negative failure?</li>
<li>What is the expected accuracy?  </li>
</ul>
<h3 id="reefer-problem-types">Reefer problem types</h3>
<p>There are multiple different potential issues that could happen to a refrigerator container. We are choosing to model the "Sensor Malfunctions" issue: Sensors in the refrigeration unit need to be calibrated and be continuously operational. An example of failure may come from the air sensor making inaccurate readings of temperatures, which leads to sploiled content. A potential reason may come from a faulty calibration, which can go unnoticed for a good time period. It may be difficult to know if there is an issue or not. </p>
<p>The other common potential issues are:</p>
<ul>
<li>Fluid leaks, like engine oil, coolant liquid. The preassure sensors added to the circuit may help identify preassure lost over time.</li>
<li>Faulty belts and hoses.</li>
<li>Faulty calibration: A non-calibrated reefer can cool at a slower or faster rate than desired.</li>
<li>Damaged Air Chute.</li>
<li>Condenser Issues like broken or damaged coils, clamps or bolts missing, and leaks.</li>
<li>Door Seals damaged. </li>
<li>Blocked air passage: to keep the temperature homogenous inside the reefer.</li>
</ul>
<p>So the question we want to answer is: does the Reefer keep accurate temperature overtime between what is set versus what is measured?</p>
<h2 id="architecture">Architecture</h2>
<p>The target production architecture is based on the data and AI reference architecture, adapted for real time analytics. It is very close to what <a href="https://opendatahub.io/">Open Data Hub</a> architecture looks like.</p>
<p><img alt="" src="../images/RT-analytics.png" /></p>
<p>The Reefer container,a as IoT device emits container metrics avery minutes via the MQTT protocol. The first component receiving those messages is Apache Nifi to transform the message to a kafka events. Kafka is used as the event backbone and event sourcin so microservices, deployed on openshift, can consume and publish messages. </p>
<p>For persistence reason, we may leverage big data type of storage like Cassandra to persist the container metrics over a longer time period. This datasource is used for the Data Scientists to do its data preparation and build training and test sets. </p>
<p>Data scientists can run Jupyter lab on OpenShift and build a model to be deployed as python microservice, consumer of kafka events. The action will be to trigger an email for the Reefer container to be put in maintenance.</p>
<h2 id="data-set">Data set</h2>
<p>Well we do not have real Reefer data. But we may be able to simulate them. As this is not production work, we should be able to get the end to end story still working from a solution point of view.</p>
<p>The historical data need to represent failure, and represent the characteristics of a Reefer container. We can imagine it includes a lot of sensors to get interesting correlated or independant features.</p>
<p>We have implemented a simulator to create those metrics to be used to build the model inside Jupiter notebook and with sklearn or tensorflow library. </p>
<p>The simulator will be also used as an event producer to send real time events to kafka, as if the Reefer container was loaded with fresh goods and is travelling oversea. A consumer code can call the predictive model to assess if maintenance is required and post new event on a containermaintance topic.</p>
<p>Here is a diagram for the data scientist environment:</p>
<p><img alt="" src="../images/ds-env.png" /></p>
<p>For the runtime execution we will plug the model as a consumer of <code>containerMetrics</code> topic which keeps container metrics in the form of event like below, keyed by containerID.</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1234567</span><span class="p">,</span>
    <span class="nt">&quot;containerID&quot;</span><span class="p">:</span> <span class="s2">&quot;C10&quot;</span><span class="p">,</span>

<span class="p">}</span>
</pre></div>

<p>The code is under the <code>tools</code> folder. The simulator can create two types of data: poweroff or co2 </p>
<h3 id="1-poweroff">1. Poweroff</h3>
<p>When the reefer containers lose power at some time, the temperature within the container starts raising. To generate data for this scenario, start the python environment using our docker image and the script - startPythonEnv</p>
<div class="codehilite"><pre><span></span> ./startPythonEnv 
</pre></div>

<p>you will be in a bash within the container with the local <code>tools</code> folder mounted under the <code>/home</code> folder.</p>
<p>The simulator accepts different arguments: </p>
<div class="codehilite"><pre><span></span>sage reefer_simulator --stype [poweroff | co2sensor | atsea]
     --cid &lt;container ID&gt;
     --records &lt;the number of records to generate&gt;
     --temp &lt;expected temperature for the goods&gt;
     --file &lt;the filename to create (without .csv)&gt;
     --append [yes | no]  (reuse the data file)
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">root</span><span class="mf">@03721594782f</span><span class="o">:</span> <span class="n">cd</span> <span class="n">home</span>
<span class="n">root</span><span class="mf">@03721594782f</span><span class="o">:</span> <span class="n">python</span> <span class="n">reefer_simulator</span><span class="p">.</span><span class="n">py</span> <span class="o">--</span><span class="n">stype</span> <span class="n">poweroff</span> <span class="o">--</span><span class="n">cid</span> <span class="mi">101</span> <span class="o">--</span><span class="n">records</span> <span class="mi">1000</span> <span class="o">-</span><span class="n">temp</span> <span class="mi">4</span> <span class="o">--</span><span class="n">file</span> <span class="n">testdata</span> <span class="o">--</span><span class="n">append</span> <span class="n">yes</span>

<span class="n">Generating</span>  <span class="mi">1000</span>  <span class="n">poweroff</span> <span class="n">metrics</span>
<span class="n">Timestamp</span>   <span class="n">ID</span>  <span class="n">Temperature</span><span class="p">(</span><span class="n">celsius</span><span class="p">)</span> <span class="n">Target_Temperature</span><span class="p">(</span><span class="n">celsius</span><span class="p">)</span>      <span class="n">Power</span>  <span class="n">PowerConsumption</span> <span class="n">ContentType</span>  <span class="n">O2</span> <span class="n">CO2</span>  <span class="n">Time_Door_Open</span> <span class="n">Maintenance_Required</span> <span class="n">Defrost_Cycle</span>
<span class="mf">1.000000</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">3.416766</span>                           <span class="mi">4</span>  <span class="mf">17.698034</span>          <span class="mf">6.662044</span>           <span class="mi">1</span>  <span class="mi">11</span>   <span class="mi">1</span>        <span class="mf">8.735273</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.001001</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">4.973630</span>                           <span class="mi">4</span>   <span class="mf">3.701072</span>          <span class="mf">8.457314</span>           <span class="mi">1</span>  <span class="mi">13</span>   <span class="mi">3</span>        <span class="mf">5.699655</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.002002</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">1.299275</span>                           <span class="mi">4</span>   <span class="mf">7.629094</span>          <span class="mf">7.174810</span>           <span class="mi">1</span>  <span class="mi">15</span>   <span class="mi">1</span>        <span class="mf">7.146702</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.003003</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">5.371080</span>                           <span class="mi">4</span>   <span class="mf">5.857190</span>          <span class="mf">6.542220</span>           <span class="mi">1</span>   <span class="mi">0</span>   <span class="mi">3</span>        <span class="mf">4.305004</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.004004</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">5.371080</span>                           <span class="mi">4</span>   <span class="mf">0.000000</span>          <span class="mf">7.145957</span>           <span class="mi">1</span>   <span class="mi">0</span>   <span class="mi">0</span>        <span class="mf">8.305748</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.005005</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">30</span> <span class="nl">T15</span><span class="p">:</span><span class="mi">43</span> <span class="n">Z</span>  <span class="mi">101</span>              <span class="mf">6.971080</span>                           <span class="mi">4</span>   <span class="mf">0.000000</span>          <span class="mf">6.438677</span>           <span class="mi">1</span>   <span class="mi">1</span>   <span class="mi">0</span>        <span class="mf">6.495389</span>                    <span class="mi">0</span>             <span class="mi">6</span>
<span class="mf">1.</span>
</pre></div>

<h3 id="2-co2-sensor-malfunction">2. Co2 sensor malfunction</h3>
<p>In the same way as above the simulator can generate data for Co2 sensor malfunction, using the below command,
<div class="codehilite"><pre><span></span>python reefer_simulator.py co2sensor 101 1000 4 testdata no
</pre></div></p>
<p>To build the data set we are using the following approaches:</p>
<ol>
<li>
<p>When the door of the reefer container is open</p>
<p>We are using exponential distribution here to generate data which varies at a very fast rate.</p>
</li>
<li>
<p>When there is a sensor malfunction (or sensors are incorrectly calibrated)</p>
<p>We are using random gaussian distribution here to generate data with arbitrary variations</p>
</li>
<li>
<p>When the reefer container is functioning as expected (baseline/groundtruth for our model)</p>
<p>We are using uniform distribution here to generate expected data.</p>
</li>
</ol>
<p>The features we are creating are:
<div class="codehilite"><pre><span></span>=====================
Timestamp, ID, Temperature(celsius), Target_Temperature(celsius), Amp, CumulativePowerConsumption, ContentType, Humidity, CO2, Door_Open, Maintainence_Required, Defrost_Cycle
=====================
</pre></div></p>
<h2 id="modeling-techniques">Modeling techniques</h2>
<p>The model uses the generated data from above scenarios: </p>
<ol>
<li>When the container's door is open for a longer time - this gives a false positive that maintainence is required.</li>
<li>When sensors are malfunctioning, it records arbitrary readings.</li>
<li>When the readings are normal. We have currently trained our model on 3000 datapoints from the three scenarios above. </li>
</ol>
<p>There are different modeling approach to tackle predictive maintenance:</p>
<ul>
<li>regression model</li>
<li>classification to predict failure for a given time period</li>
<li>classify anomalous behavior: classes are not known in advance. Normal operation is known.</li>
<li>compute probability of failure over time</li>
</ul>
<h3 id="code-execution">Code execution</h3>
<p>The simulator continuosly generates container metrics, publishes it to Kafka and run the predictMaintainence.ipynb to predict if maintainence is sought at this point in time. </p>
<h2 id="model-description">Model description</h2>
<p>We are using Machine Learning supervised learning here. There are two types of supervised learning - 1) Classification: Predict a categorical response, 2) Regression: Predict a continuous response</p>
<h3 id="linear-regression">Linear regression</h3>
<p>Pros: 1) Fast 2) No tuning required 3) Highly interpretable 4) Well-understood</p>
<p>Cons: 1) Unlikely to produce the best predictive accuracy 2) Presumes a linear relationship between the features and response 3) If the relationship is highly non-linear as with many scenarios, linear relationship will not effectively model the relationship and its prediction would not be accurate</p>
<h3 id="naive-bayes-classification">Naive Bayes classification</h3>
<p>Naive Bayes is a probabilistic classifier inspired by the Bayes theorem under a simple assumption which is the attributes are conditionally independent.</p>
<p>The classification is conducted by deriving the maximum posterior which is the maximal P(Ci|X) with the above assumption applying to Bayes theorem. This assumption greatly reduces the computational cost by only counting the class distribution. Even though the assumption is not valid in most cases since the attributes are dependent, surprisingly Naive Bayes has able to perform impressively.</p>
<p>Naive Bayes is a very simple algorithm to implement and good results have obtained in most cases. It can be easily scalable to larger datasets since it takes linear time, rather than by expensive iterative approximation as used for many other types of classifiers.</p>
<p>Naive Bayes can suffer from a problem called the zero probability problem. When the conditional probability is zero for a particular attribute, it fails to give a valid prediction. This needs to be fixed explicitly using a Laplacian estimator.</p>
<h2 id="model-evaluation">Model evaluation</h2>
<p>We are using Root Mean Squared Error (RMSE) for evaluating the model performance.</p>
<p>Root Mean Squared Error (RMSE) is the square root of the mean of the squared errors.</p>
<p>Classification does better here as the scenarion is more of a classification problem.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://cargostore.com/blog/what-are-reefer-containers/">Understand Reefer container</a></li>
<li>For modeling predictive maintenance we found <a href="https://medium.com/bigdatarepublic/machine-learning-for-predictive-maintenance-where-to-start-5f3b7586acfb">this article</a> from BigData Republique, on Medium, very interesting. </li>
<li><a href="http://www.sfb637.uni-bremen.de/pubdb/repository/SFB637-B6-10-011-IC.pdf">PREDICTION OF TEMPERATURE INSIDE A REFRIGERATED CONTAINER IN THE PRESENCE OF PERISHABLE GOODS</a></li>
<li>
<p><a href="https://www.omega.com/technical-learning/temperature-monitoring-during-transportation.html">Temperature Monitoring During Transportation, Storage and Processing of Perishable Products</a></p>
</li>
<li>
<p><a href="https://towardsdatascience.com/machine-learning-classifiers-a5cc4e1b0623">Understanding machine learning classifiers</a></p>
</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../integration-tests/" title="Run integration tests" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Run integration tests
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>